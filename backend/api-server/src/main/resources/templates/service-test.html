<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${title}">NeogulMap ì„œë¹„ìŠ¤ í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .service-section {
            margin-bottom: 40px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: #fafafa;
        }
        .service-title {
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .test-button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
        }
        .test-button:hover {
            background-color: #2980b9;
        }
        .test-button.success {
            background-color: #27ae60;
        }
        .test-button.danger {
            background-color: #e74c3c;
        }
        .test-form {
            background: white;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .form-group {
            margin-bottom: 15px;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        .result {
            margin-top: 15px;
            padding: 10px;
            border-radius: 5px;
            white-space: pre-wrap;
            font-family: monospace;
        }
        .result.success {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        .result.error {
            background-color: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 th:text="${title}">NeogulMap ì„œë¹„ìŠ¤ í…ŒìŠ¤íŠ¸</h1>
        
        <div class="grid">
            <!-- User Service í…ŒìŠ¤íŠ¸ -->
            <div class="service-section">
                <h2 class="service-title">ğŸ‘¤ User Service í…ŒìŠ¤íŠ¸</h2>
                
                <a href="/test/users" class="test-button">ì‚¬ìš©ì ëª©ë¡ ì¡°íšŒ</a>
                <button onclick="testUserService()" class="test-button">ì‚¬ìš©ì ìƒì„± í…ŒìŠ¤íŠ¸</button>
                <button onclick="testGetUser()" class="test-button">ì‚¬ìš©ì ì¡°íšŒ í…ŒìŠ¤íŠ¸</button>
                
                <div class="test-form">
                    <h4>ì‚¬ìš©ì ìƒì„± í…ŒìŠ¤íŠ¸</h4>
                    <div class="form-group">
                        <label>ì´ë©”ì¼:</label>
                        <input type="email" id="userEmail" value="test@example.com">
                    </div>
                    <div class="form-group">
                        <label>ë‹‰ë„¤ì„:</label>
                        <input type="text" id="userNickname" value="í…ŒìŠ¤íŠ¸ìœ ì €">
                    </div>
                    <div class="form-group">
                        <label>OAuth ID:</label>
                        <input type="text" id="userOauthId" value="oauth123">
                    </div>
                    <div class="form-group">
                        <label>OAuth Provider:</label>
                        <select id="userOauthProvider">
                            <option value="GOOGLE">Google</option>
                            <option value="KAKAO">Kakao</option>
                            <option value="NAVER">Naver</option>
                        </select>
                    </div>
                </div>
                
                <div class="test-form">
                    <h4>ì‚¬ìš©ì ì¡°íšŒ í…ŒìŠ¤íŠ¸</h4>
                    <div class="form-group">
                        <label>ì‚¬ìš©ì ID:</label>
                        <input type="number" id="userId" value="1">
                    </div>
                </div>
                
                <div id="userResult" class="result" style="display: none;"></div>
            </div>

            <!-- Zone Service í…ŒìŠ¤íŠ¸ -->
            <div class="service-section">
                <h2 class="service-title">ğŸ“ Zone Service í…ŒìŠ¤íŠ¸</h2>
                
                <a href="/test/zones" class="test-button">Zone ëª©ë¡ ì¡°íšŒ</a>
                <button onclick="testZoneService()" class="test-button">Zone ìƒì„± í…ŒìŠ¤íŠ¸</button>
                <button onclick="testGetZone()" class="test-button">Zone ì¡°íšŒ í…ŒìŠ¤íŠ¸</button>
                <button onclick="testSearchZones()" class="test-button">Zone ê²€ìƒ‰ í…ŒìŠ¤íŠ¸</button>
                <button onclick="testNearbyZones()" class="test-button success">ğŸ“ ë°˜ê²½ ê²€ìƒ‰ í…ŒìŠ¤íŠ¸</button>
                
                <div class="test-form">
                    <h4>Zone ìƒì„± í…ŒìŠ¤íŠ¸</h4>
                    <div class="form-group">
                        <label>Zone ì´ë¦„:</label>
                        <input type="text" id="zoneName" value="í…ŒìŠ¤íŠ¸ í¡ì—°êµ¬ì—­">
                    </div>
                    <div class="form-group">
                        <label>ì£¼ì†Œ:</label>
                        <input type="text" id="zoneAddress" value="ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 123">
                    </div>
                    <div class="form-group">
                        <label>ì„¤ëª…:</label>
                        <textarea id="zoneDescription">í…ŒìŠ¤íŠ¸ìš© í¡ì—°êµ¬ì—­ì…ë‹ˆë‹¤.</textarea>
                    </div>
                    <div class="form-group">
                        <label>ì´ë¯¸ì§€:</label>
                        <input type="file" id="zoneImage" accept="image/*">
                    </div>
                </div>
                
                <div class="test-form">
                    <h4>Zone ì¡°íšŒ/ê²€ìƒ‰ í…ŒìŠ¤íŠ¸</h4>
                    <div class="form-group">
                        <label>Zone ID:</label>
                        <input type="number" id="zoneId" value="1">
                    </div>
                    <div class="form-group">
                        <label>ê²€ìƒ‰ í‚¤ì›Œë“œ:</label>
                        <input type="text" id="searchKeyword" value="ê°•ë‚¨">
                    </div>
                </div>
                
                <div class="test-form">
                    <h4>ğŸ“ ë°˜ê²½ ê²€ìƒ‰ í…ŒìŠ¤íŠ¸ (ìœ„ì¹˜ ê¸°ë°˜)</h4>
                    <div class="form-group">
                        <label>ìœ„ë„ (Latitude):</label>
                        <input type="number" id="searchLat" value="37.5665" step="0.0001" placeholder="37.5665">
                    </div>
                    <div class="form-group">
                        <label>ê²½ë„ (Longitude):</label>
                        <input type="number" id="searchLon" value="126.9780" step="0.0001" placeholder="126.9780">
                    </div>
                    <div class="form-group">
                        <label>ë°˜ê²½ (ë¯¸í„°):</label>
                        <input type="number" id="searchRadius" value="5000" placeholder="5000">
                    </div>
                    <div class="form-group">
                        <small>ğŸ’¡ í…ŒìŠ¤íŠ¸ ì¢Œí‘œ: ê°•ë‚¨ì—­(37.4979, 127.0276), í™ëŒ€(37.5563, 126.9226), ëª…ë™(37.5636, 126.9826)</small>
                    </div>
                </div>
                
                <div id="zoneResult" class="result" style="display: none;"></div>
            </div>

            <!-- Image Service í…ŒìŠ¤íŠ¸ -->
            <div class="service-section">
                <h2 class="service-title">ğŸ–¼ï¸ Image Service í…ŒìŠ¤íŠ¸</h2>
                
                <button onclick="testImageUpload()" class="test-button">ì´ë¯¸ì§€ ì—…ë¡œë“œ í…ŒìŠ¤íŠ¸</button>
                <button onclick="testImageGet()" class="test-button">ì´ë¯¸ì§€ ì¡°íšŒ í…ŒìŠ¤íŠ¸</button>
                
                <div class="test-form">
                    <h4>ì´ë¯¸ì§€ ì—…ë¡œë“œ í…ŒìŠ¤íŠ¸</h4>
                    <div class="form-group">
                        <label>ì´ë¯¸ì§€ íŒŒì¼:</label>
                        <input type="file" id="imageFile" accept="image/*">
                    </div>
                    <div class="form-group">
                        <label>ì´ë¯¸ì§€ íƒ€ì…:</label>
                        <select id="imageType">
                            <option value="PROFILE">Profile</option>
                            <option value="ZONE">Zone</option>
                        </select>
                    </div>
                </div>
                
                <div class="test-form">
                    <h4>ì´ë¯¸ì§€ ì¡°íšŒ í…ŒìŠ¤íŠ¸</h4>
                    <div class="form-group">
                        <label>íŒŒì¼ëª…:</label>
                        <input type="text" id="imageFileName" placeholder="ì˜ˆ: profile_20241210_123456_abc12345.jpg">
                    </div>
                </div>
                
                <div id="imageResult" class="result" style="display: none;"></div>
            </div>

            <!-- Storage Service í…ŒìŠ¤íŠ¸ -->
            <div class="service-section">
                <h2 class="service-title">ğŸ’¾ Storage Service í…ŒìŠ¤íŠ¸</h2>
                
                <button onclick="testStorageService()" class="test-button">Storage í…ŒìŠ¤íŠ¸</button>
                
                <div class="test-form">
                    <h4>Storage ì„œë¹„ìŠ¤ í…ŒìŠ¤íŠ¸</h4>
                    <div class="form-group">
                        <label>í…ŒìŠ¤íŠ¸ íŒŒì¼:</label>
                        <input type="file" id="storageFile">
                    </div>
                </div>
                
                <div id="storageResult" class="result" style="display: none;"></div>
            </div>
        </div>

        <!-- í†µí•© í…ŒìŠ¤íŠ¸ -->
        <div class="service-section">
            <h2 class="service-title">ğŸ”§ í†µí•© í…ŒìŠ¤íŠ¸</h2>
            <button onclick="testHealthCheck()" class="test-button success">ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸</button>
            <a href="/test/advanced" class="test-button">ê³ ê¸‰ í…ŒìŠ¤íŠ¸ í˜ì´ì§€</a>
            <div id="healthResult" class="result" style="display: none;"></div>
        </div>
    </div>

    <script>
        // User Service í…ŒìŠ¤íŠ¸
        async function testUserService() {
            const userData = {
                email: document.getElementById('userEmail').value,
                nickname: document.getElementById('userNickname').value,
                oauthId: document.getElementById('userOauthId').value,
                oauthProvider: document.getElementById('userOauthProvider').value,
                createdAt: new Date().toISOString()
            };

            try {
                const response = await fetch('/test/users', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(userData)
                });
                const result = await response.json();
                showResult('userResult', result, response.ok);
            } catch (error) {
                showResult('userResult', {error: error.message}, false);
            }
        }

        async function testGetUser() {
            const userId = document.getElementById('userId').value;
            try {
                const response = await fetch(`/test/users/${userId}`);
                const result = await response.json();
                showResult('userResult', result, response.ok);
            } catch (error) {
                showResult('userResult', {error: error.message}, false);
            }
        }

        // Zone Service í…ŒìŠ¤íŠ¸
        async function testZoneService() {
            const formData = new FormData();
            formData.append('name', document.getElementById('zoneName').value);
            formData.append('address', document.getElementById('zoneAddress').value);
            formData.append('description', document.getElementById('zoneDescription').value);
            
            const imageFile = document.getElementById('zoneImage').files[0];
            if (imageFile) {
                formData.append('image', imageFile);
            }

            try {
                const response = await fetch('/test/zones', {
                    method: 'POST',
                    body: formData
                });
                const result = await response.json();
                showResult('zoneResult', result, response.ok);
            } catch (error) {
                showResult('zoneResult', {error: error.message}, false);
            }
        }

        async function testGetZone() {
            const zoneId = document.getElementById('zoneId').value;
            try {
                const response = await fetch(`/test/zones/${zoneId}`);
                const result = await response.json();
                showResult('zoneResult', result, response.ok);
            } catch (error) {
                showResult('zoneResult', {error: error.message}, false);
            }
        }

        async function testSearchZones() {
            const keyword = document.getElementById('searchKeyword').value;
            try {
                const response = await fetch(`/test/zones/search?keyword=${encodeURIComponent(keyword)}`);
                const result = await response.json();
                showResult('zoneResult', result, response.ok);
            } catch (error) {
                showResult('zoneResult', {error: error.message}, false);
            }
        }

        async function testNearbyZones() {
            const lat = document.getElementById('searchLat').value;
            const lon = document.getElementById('searchLon').value;
            const radius = document.getElementById('searchRadius').value;
            
            if (!lat || !lon) {
                showResult('zoneResult', {error: 'ìœ„ë„ì™€ ê²½ë„ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”'}, false);
                return;
            }
            
            try {
                const response = await fetch(`/test/zones/nearby?lat=${lat}&lon=${lon}&radius=${radius}`);
                const result = await response.json();
                showResult('zoneResult', result, response.ok);
            } catch (error) {
                showResult('zoneResult', {error: error.message}, false);
            }
        }

        // Image Service í…ŒìŠ¤íŠ¸
        async function testImageUpload() {
            const imageFile = document.getElementById('imageFile').files[0];
            const imageType = document.getElementById('imageType').value;

            if (!imageFile) {
                showResult('imageResult', {error: 'ì´ë¯¸ì§€ íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”'}, false);
                return;
            }

            const formData = new FormData();
            formData.append('image', imageFile);
            formData.append('type', imageType);

            try {
                const response = await fetch('/test/images/upload', {
                    method: 'POST',
                    body: formData
                });
                const result = await response.json();
                showResult('imageResult', result, response.ok);
            } catch (error) {
                showResult('imageResult', {error: error.message}, false);
            }
        }

        async function testImageGet() {
            const fileName = document.getElementById('imageFileName').value;
            if (!fileName) {
                showResult('imageResult', {error: 'íŒŒì¼ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”'}, false);
                return;
            }

            try {
                const response = await fetch(`/test/images/${fileName}`);
                if (response.ok) {
                    showResult('imageResult', {message: 'ì´ë¯¸ì§€ ì¡°íšŒ ì„±ê³µ', fileName: fileName}, true);
                } else {
                    showResult('imageResult', {error: 'ì´ë¯¸ì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤'}, false);
                }
            } catch (error) {
                showResult('imageResult', {error: error.message}, false);
            }
        }

        // Storage Service í…ŒìŠ¤íŠ¸
        async function testStorageService() {
            const file = document.getElementById('storageFile').files[0];
            if (!file) {
                showResult('storageResult', {error: 'íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”'}, false);
                return;
            }

            const formData = new FormData();
            formData.append('file', file);

            try {
                const response = await fetch('/storage/test', {
                    method: 'POST',
                    body: formData
                });
                const result = await response.json();
                showResult('storageResult', result, response.ok);
            } catch (error) {
                showResult('storageResult', {error: error.message}, false);
            }
        }

        // í†µí•© í…ŒìŠ¤íŠ¸
        async function testHealthCheck() {
            try {
                const response = await fetch('/test/health');
                const result = await response.json();
                showResult('healthResult', result, response.ok);
            } catch (error) {
                showResult('healthResult', {error: error.message}, false);
            }
        }

        // ê²°ê³¼ í‘œì‹œ í•¨ìˆ˜
        function showResult(elementId, data, isSuccess) {
            const element = document.getElementById(elementId);
            element.style.display = 'block';
            element.className = `result ${isSuccess ? 'success' : 'error'}`;
            element.textContent = JSON.stringify(data, null, 2);
        }
    </script>
</body>
</html>
