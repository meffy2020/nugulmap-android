# 🦝 앱프로그래밍 최종 프로젝트 보고서

## 1. 앱 주제 및 핵심 기능 설명

### 1.1 주제 선정 배경
도심 내 흡연구역에 대한 정보 부족은 흡연자와 비흡연자 모두에게 큰 불편을 야기합니다. 흡연자는 지정된 장소를 찾지 못해 무심코 금연구역에서 흡연하게 되고, 비흡연자는 예기치 못한 간접흡연 피해를 입게 됩니다.

흡연구역 알리미 서비스인 너굴맵은 이러한 도시 문제를 해결하기 위해 기획되었습니다. 사용자가 현재 위치를 기반으로 **공식 및 제보된 흡연구역을 지도에서 즉시 확인**할 수 있도록 함으로써, 성숙한 흡연 문화를 조성하고 비흡연자의 권리를 보호하고자 합니다.

### 1.2 핵심 기능
1.  **실시간 지도 서비스:** 카카오맵 SDK를 사용하여 주변 흡연구역을 마커로 시각화합니다.
2.  **내 위치 기반 탐색:** GPS 기능을 통해 사용자의 현재 위치를 추적하고, 주변 장소를 자동으로 로드합니다.
3.  **장소 상세 정보:** 선택한 장소의 주소, 유형(실외/부스 등), 상세 설명을 바텀시트(Bottom Sheet)로 제공합니다.
4.  **카카오 로그인 연동:** 카카오 계정을 통한 간편 인증 시스템을 구축하여 편의성을 높였습니다.
5.  **신규 장소 제보:** 사용자가 직접 장소를 지도에서 선택하고 정보를 입력하여 데이터베이스에 기여할 수 있습니다.
6.  **외부 지도 연동:** 상세 정보에서 '카카오맵에서 열기'를 통해 실제 경로 안내를 받을 수 있습니다.

---

## 2. 전체 화면 구성 요약

### 2.1 주요 화면 (스크린샷)

<table style="width: 100%; border-collapse: collapse;">
  <tr>
    <td align="center" style="width: 33%; padding: 5px;"><img src="./1.png" width="160"></td>
    <td align="center" style="width: 33%; padding: 5px;"><img src="./2.png" width="160"></td>
    <td align="center" style="width: 33%; padding: 5px;"><img src="./3.png" width="160"></td>
  </tr>
  <tr>
    <td align="center" style="font-size: 0.9em;"><b>그림 1. 로그인</b><br>카카오 간편 로그인</td>
    <td align="center" style="font-size: 0.9em;"><b>그림 2. 메인 지도</b><br>내 주변 구역 탐색</td>
    <td align="center" style="font-size: 0.9em;"><b>그림 3. 장소 등록</b><br>새로운 구역 제보</td>
  </tr>
</table>

### 2.2 화면별 상세 설명

**1. 로그인 화면 (LoginScreen)**
*   **개요:** 서비스 진입을 위한 인증 화면입니다.
*   **기능:** '카카오 로그인' 버튼을 제공하며, 로그인 성공 시 백엔드로부터 **JWT 토큰**을 발급받아 홈 화면으로 진입합니다.

**2. 메인 홈 화면 (HomeScreen)**
*   **개요:** 서비스의 중심인 지도 기반 화면입니다.
*   **구성 요소:**
    *   **카카오맵:** 흡연구역 마커가 표시되는 인터랙티브 지도입니다.
    *   **내 위치 버튼:** 클릭 시 사용자의 현재 GPS 위치로 지도를 이동시킵니다.
    *   **추가 버튼:** 새로운 흡연구역을 제보하기 위한 모달을 엽니다.
    *   **장소 상세 바텀시트:** 마커 클릭 시 나타나며 주소, 설명, 태그 정보를 포함합니다.

**3. 장소 등록 모달 (AddLocationModal)**
*   **개요:** 새로운 장소 정보를 입력하는 폼 화면입니다.
*   **기능:** 지도를 길게 눌러 지정된 위치를 바탕으로 장소 이름, 유형 등을 입력하여 서버에 등록합니다.

### 2.3 UI 흐름과 사용자 경험 (UX)
사용자가 앱을 사용하는 전체적인 흐름은 **최소한의 입력으로 최대한의 정보 획득**에 초점을 맞추었습니다.

<img src="./UX_flow.png" width="500">

1.  **진입 단계:** 앱 실행 후 카카오 버튼 클릭 한 번으로 로그인을 완료합니다.
2.  **탐색 단계:** 홈 화면 진입 시 사용자의 현재 위치 주변 흡연구역이 자동으로 나타납니다.
3.  **확인 단계:** 마커를 터치하면 바텀시트가 올라와 핵심 정보를 요약해 보여줍니다.
4.  **연동 단계:** 길안내가 필요한 경우 외부 지도 앱으로 자연스럽게 전환됩니다.
5.  **기여 단계:** 지도를 길게 누르는 동작만으로 제보 과정의 번거로움을 최소화했습니다.

---

## 3. 사용 기술 및 패키지

### 3.1 Android (Client)
*   **언어:** Kotlin 1.9
*   **UI:** **Jetpack Compose** (Material Design 3)
*   **아키텍처:** **MVVM + Clean Architecture**
*   **의존성 주입:** Hilt
*   **네트워크:** Retrofit2, OkHttp3 (**JWT Interceptor** 포함)
*   **지도:** KakaoMap Android SDK v2
*   **인증:** Kakao User SDK
*   **로컬 저장소:** Jetpack DataStore

### 3.2 Backend (API Server)
*   **프레임워크:** **Spring Boot 3.3.4** (Java 21)
*   **데이터베이스:** H2 Database (In-Memory)
*   **보안:** Spring Security 6 + **JWT**
*   **빌드 도구:** Gradle

### 3.3 Data Engineering
*   **언어:** Python 3.11
*   **프레임워크:** **FastAPI**
*   **데이터 처리:** **Pandas**
*   **역할:** 공공데이터(CSV) 수집, 위경도 좌표 정제, 백엔드 초기 데이터 적재 자동화.

---

## 4. 기능별 구현 상세 내용

### 4.1 데이터 파이프라인 (Python & FastAPI)
공공데이터 포털에서 수집한 지자체별 흡연구역 CSV 파일들을 통합 관리하기 위한 파이프라인을 구축했습니다.
*   **CSV 파싱:** Pandas를 사용하여 지자체마다 다른 컬럼명과 인코딩을 표준화했습니다.
*   **좌표 정제:** 주소 정보만 있는 데이터는 Kakao API를 활용해 **지오코딩**을 수행했습니다.
*   **자동 적재:** FastAPI를 통해 정제된 데이터를 백엔드 서버에 자동으로 적재했습니다.

### 4.2 카카오 로그인 및 서버 인증
*   **Flow:** 카카오 SDK로 획득한 AccessToken을 백엔드의 `/api/auth/login/kakao`로 전송합니다.
*   **JWT 발급:** 백엔드 서버는 토큰 검증 후 자체 서명된 **JWT**를 발급하여 클라이언트에 전달합니다.
*   **Interceptor:** 모든 API 호출 시 헤더에 **Authorization** 정보를 자동으로 포함하도록 설계했습니다.

### 4.3 지도 인터랙션 및 위치 추적
*   **지도 제어:** CameraUpdateFactory를 사용하여 줌 레벨 변화 없이 부드러운 화면 이동을 구현했습니다.
*   **마커 관리:** LabelLayer를 통해 지도 위에 구역 정보를 렌더링하고 ViewModel과 이벤트를 연결했습니다.

---

## 5. 구현 중 문제와 해결 전략

### 5.1 문제: 안드로이드 에뮬레이터 GPS 인식 불가
*   **해결:** 에뮬레이터의 **Extended Controls > Location** 메뉴를 통해 서울 좌표를 수동으로 주입(Mocking)하여 실제 하드웨어가 없는 환경에서도 위치 기반 기능을 검증했습니다.

### 5.2 문제: 카카오 로그인 후 앱 복귀 실패
*   **해결:** `AndroidManifest.xml`에 **AuthCodeHandlerActivity**와 Redirect URI 설정을 추가하여 인증 완료 후 앱으로 정상 복귀하도록 수정했습니다.

### 5.3 문제: 서버 DTO 필드 불일치
*   **해결:** 전송 시점에 **전용 Map 객체**를 구성하여 서버가 요구하는 스펙에 정확히 맞는 JSON 데이터만 선별적으로 전송하도록 로직을 개선했습니다.

---

## 6. 회고 및 개선 아이디어

프로젝트를 통해 데이터 수집부터 서버 구축, 앱 구현까지 서비스의 전 과정을 경험하며 풀스택 개발자로서의 역량을 쌓을 수 있었습니다.

**향후 개선 아이디어:**
1.  **데이터 시각화 강화:** 마커 클러스터링을 도입하여 가독성 개선.
2.  **커뮤니티 요소 추가:** 사용자의 리뷰 및 실시간 혼잡도 공유 기능.
3.  **성능 최적화:** 지도 데이터의 로컬 캐싱을 통한 로딩 속도 향상.

---

## 7. 결론: 문제 해결 과정 및 느낀 점 요약

이번 프로젝트는 **Data - Backend - Android**로 이어지는 전체 파이프라인을 직접 설계하고 조율해 본 뜻깊은 경험이었습니다. 특히 시스템 간의 정합성을 맞추는 과정에서 철저한 설계의 중요성을 깨달았습니다.

공공데이터를 정제하여 실시간 지도로 시각화했을 때 데이터가 하나의 서비스로 재탄생하는 과정에서 큰 보람을 느꼈습니다. 이번 경험을 통해 기술적 성장은 물론, 사용자의 불편함을 기술로 우아하게 해결하는 개발자가 되고 싶다는 목표를 갖게 되었습니다.

---